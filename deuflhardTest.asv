
%% Problem from p 17
omega = 50;
ddq = @(q1, q2) [omega^2/2*(q2-q1) + 4*(q1-q2)^3;...
                -omega^2/2*(q2-q1) - 4*(q1-q2)^3];

% initial values
q10 = 0;
dq10 = 1;
q20 = 1;
dq20 = 0;


%% Step size and number of steps
N = 1e2;     % 1e4 steps
h = 7.5 / N; % Interval [0, 7.5] (p 46)

%% Solve ODE
tic

% Deuflhard method
[q1, q] = verlet_refined(@(q) dp(0, q), p0, q0, h, N, 5, 'suzuki', true);

toc
